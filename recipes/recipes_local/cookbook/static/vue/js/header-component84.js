"use strict";(self["webpackChunktandoor"]=self["webpackChunktandoor"]||[]).push([[3448],{11072:function(t,o,e){e.r(o),e.d(o,{default:function(){return m}});var a=function(){var t=this,o=t._self._c;return o("div",[o("b-modal",{staticClass:"modal",attrs:{id:`id_modal_add_book_${t.modal_id}`,title:t.$t("Manage_Books"),"ok-title":t.$t("Add"),"cancel-title":t.$t("Close")},on:{ok:function(o){return t.addToBook()},shown:t.loadBookEntries}},[o("ul",{staticClass:"list-group"},t._l(this.recipe_book_list,(function(e){return o("li",{key:e.id,staticClass:"list-group-item d-flex justify-content-between align-items-center"},[t._v(" "+t._s(e.book_content.name)+" "),o("span",{staticClass:"btn btn-sm btn-danger",on:{click:function(o){return t.removeFromBook(e)}}},[o("i",{staticClass:"fa fa-trash-alt"})])])})),0),o("multiselect",{staticStyle:{"margin-top":"1vh"},attrs:{options:t.books_filtered,taggable:!0,"tag-placeholder":t.$t("Create"),placeholder:t.$t("Select_Book"),label:"name","track-by":"id",id:"id_books",multiple:!1,loading:t.books_loading},on:{tag:t.createBook,"search-change":t.loadBooks},model:{value:t.selected_book,callback:function(o){t.selected_book=o},expression:"selected_book"}})],1)],1)},i=[],s=(e(57658),e(47907)),n=e.n(s),d=e(30381),l=e.n(d),r=e(70538),c=e(12120),k=e(6955),p=e(49665);r["default"].prototype.moment=l(),r["default"].use(c.XG7);var u={name:"AddRecipeToBook",components:{Multiselect:n()},props:{recipe:Object,modal_id:Number},data(){return{books:[],books_loading:!1,recipe_book_list:[],selected_book:null}},computed:{books_filtered:function(){let t=[];return this.books.forEach((o=>{0===this.recipe_book_list.filter((t=>t.book===o.id)).length&&t.push(o)})),t}},mounted(){},methods:{loadBooks:function(t){this.books_loading=!0;let o=new k.ApiApiFactory;o.listRecipeBooks({query:{query:t}}).then((t=>{this.books=t.data.filter((t=>-1===this.recipe_book_list.indexOf(t))),this.books_loading=!1}))},createBook:function(t){let o=new k.ApiApiFactory;o.createRecipeBook({name:t}).then((t=>{this.books.push(t.data),this.selected_book=t.data,p.StandardToasts.makeStandardToast(this,p.StandardToasts.SUCCESS_CREATE)}))},addToBook:function(){let t=new k.ApiApiFactory;t.createRecipeBookEntry({book:this.selected_book.id,recipe:this.recipe.id}).then((t=>{this.recipe_book_list.push(t.data),p.StandardToasts.makeStandardToast(this,p.StandardToasts.SUCCESS_CREATE)})).catch((t=>{p.StandardToasts.makeStandardToast(this,p.StandardToasts.FAIL_UPDATE,t)}))},removeFromBook:function(t){let o=new k.ApiApiFactory;o.destroyRecipeBookEntry(t.id).then((o=>{this.recipe_book_list=this.recipe_book_list.filter((o=>o.id!==t.id)),p.StandardToasts.makeStandardToast(this,p.StandardToasts.SUCCESS_DELETE)}))},loadBookEntries:function(){let t=new k.ApiApiFactory;t.listRecipeBookEntrys({query:{recipe:this.recipe.id}}).then((t=>{this.recipe_book_list=t.data,this.loadBooks("")}))}}},_=u,h=e(1001),b=(0,h.Z)(_,a,i,!1,null,null,null),m=b.exports}}]);