"use strict";(self["webpackChunktandoor"]=self["webpackChunktandoor"]||[]).push([[1781,3451,762,228,9484,7362,3591,607,2780,479,6756,5208,3933,4634,2936],{61551:function(e,t,i){i.d(t,{s:function(){return s},x:function(){return r}});var s=function(){var e=this,t=e._self._c;return e.recipes!=={}?t("div",[t("div",{staticClass:"align-center",attrs:{id:"switcher"}},[t("i",{directives:[{name:"b-toggle",rawName:"v-b-toggle.related-recipes",modifiers:{"related-recipes":!0}}],staticClass:"btn btn-primary fas fa-receipt fa-xl fa-fw shadow-none btn-circle"})]),t("b-sidebar",{staticStyle:{"z-index":"10000"},attrs:{id:"related-recipes",backdrop:"",right:"",bottom:"","no-header":"",shadow:"sm"},on:{shown:function(t){return e.updatePinnedRecipes()}},scopedSlots:e._u([{key:"default",fn:function({hide:i}){return[t("div",{staticClass:"d-flex flex-column justify-content-end h-100 p-3 align-items-end"},[t("h5",[e._v(e._s(e.$t("Planned"))+" "),t("i",{staticClass:"fas fa-calendar fa-fw"})]),t("div",{staticClass:"text-right"},[e.planned_recipes.length>0?e._l(e.planned_recipes,(function(s){return t("div",{key:`plan${s.id}`},[t("div",{staticClass:"pb-1 pt-1"},[t("a",{attrs:{href:"javascript:void(0);"},on:{click:function(t){e.navRecipe(s),i()}}},[e._v(e._s(s.name))])])])})):[t("span",{staticClass:"text-muted"},[e._v(e._s(e.$t("nothing_planned_today")))])]],2),t("h5",[e._v(e._s(e.$t("Pinned"))+" "),t("i",{staticClass:"fas fa-thumbtack fa-fw"})]),e.pinned_recipes.length>0?[t("div",{staticClass:"text-right"},e._l(e.pinned_recipes,(function(s){return t("div",{key:`pin${s.id}`},[t("b-row",{staticClass:"pb-1 pt-1"},[t("b-col",{attrs:{cols:"2"}},[t("a",{staticClass:"text-muted",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.unPinRecipe(s)}}},[t("i",{staticClass:"fas fa-times"})])]),t("b-col",{attrs:{cols:"10"}},[t("a",{staticClass:"align-self-end",attrs:{href:"javascript:void(0);"},on:{click:function(t){e.navRecipe(s),i()}}},[e._v(e._s(s.name)+" ")])])],1)],1)})),0)]:[t("span",{staticClass:"text-muted"},[e._v(e._s(e.$t("no_pinned_recipes")))])],e.related_recipes.length>0?[t("h5",[e._v("Related "),t("i",{staticClass:"fas fa-link fa-fw"})]),t("div",{staticClass:"text-right"},e._l(e.related_recipes,(function(s){return t("div",{key:`related${s.id}`},[t("div",{staticClass:"pb-1 pt-1"},[t("a",{attrs:{href:"javascript:void(0);"},on:{click:function(t){e.navRecipe(s),i()}}},[e._v(e._s(s.name))])])])})),0)]:e._e()],2)]}},{key:"footer",fn:function({hide:i}){return[t("div",{staticClass:"d-flex bg-dark text-light align-items-center px-3 py-2"},[t("strong",{staticClass:"mr-auto"},[e._v(e._s(e.$t("Quick actions")))]),t("b-button",{attrs:{size:"sm"},on:{click:i}},[e._v(e._s(e.$t("Close")))])],1)]}}],null,!1,1200845374)})],1):e._e()},r=[]},98682:function(e,t,i){i.r(t);var s=i(61551),r=i(70179),a=(i(58536),i(1001)),n=(0,a.Z)(r.Z,s.s,s.x,!1,null,null,null);t["default"]=n.exports},68697:function(e,t,i){i.r(t),i.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",[t(e.compiled,{tag:"component",attrs:{ingredient_factor:e.ingredient_factor,code:e.code}})],1)},r=[],a=i(70538),n=i(96059),o={name:"CompileComponent",props:["code","ingredient_factor"],data(){return{compiled:null}},mounted(){this.compiled=a["default"].component("compiled-component",{props:["ingredient_factor","code"],components:{ScalableNumber:n["default"]},template:`<div>${this.code}</div>`})}},l=o,c=i(1001),d=(0,c.Z)(l,s,r,!1,null,null,null),p=d.exports},48561:function(e,t,i){i.r(t),i.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("b-input-group",[t("b-input-group-prepend",{staticClass:"d-print-none"},[t("b-button",{staticClass:"py-0 px-2",attrs:{variant:"outline-primary",size:"sm"},on:{click:function(t){return e.valueChange(e.value-1)}}},[t("b-icon",{attrs:{icon:"dash","font-scale":"1.6"}})],1)],1),t("b-form-input",{staticClass:"custom-spin-input",attrs:{variant:"outline-primary",size:e.size,value:e.value,type:"number",min:"0",number:""},on:{update:e.valueChange}}),t("b-input-group-append",{staticClass:"d-print-none"},[t("b-button",{staticClass:"py-0 px-2",attrs:{variant:"outline-primary",size:"sm"},on:{click:function(t){return e.valueChange(e.value+1)}}},[t("b-icon",{attrs:{icon:"plus","font-scale":"1.6"}})],1)],1)],1)},r=[],a=i(43022),n=i(72466),o={name:"CustomInputSpinButton",components:{BIcon:a.H,BIconDash:n.Loc,BIconPlus:n.s3j},props:{size:{type:String,required:!1,default:"md",validator:function(e){return["sm","md","lg"].includes(e)}},value:{type:Number,required:!0}},methods:{valueChange(e){e<=0?this.$emit("input",0):this.$emit("input",e)}}},l=o,c=i(1001),d=(0,c.Z)(l,s,r,!1,null,"4891f0fc",null),p=d.exports},21832:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"text-align":"center"}},[t("b-img",{attrs:{src:e.pdfUrl,alt:e.$t("External_Recipe_Image")}})],1)},r=[],a=i(49665),n={name:"ImageViewer",props:{recipe:Object},computed:{pdfUrl:function(){return(0,a.resolveDjangoUrl)("api_get_recipe_file",this.recipe.id)}}},o=n,l=i(1001),c=(0,l.Z)(o,s,r,!1,null,null,null),d=c.exports},91515:function(e,t,i){i.r(t),i.d(t,{default:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ingredients",class:{"card border-primary no-border":e.header}},[t("div",{class:{"card-body":e.header,"p-0":e.header}},[e.header?t("div",{staticClass:"card-header"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-6"},[t("h4",{staticClass:"card-title"},[t("i",{staticClass:"fas fa-pepper-hot"}),e._v(" "+e._s(e.$t("Ingredients")))])])])]):e._e(),t("div",{staticClass:"card-body p-1 p-md-3"},[t("div",{staticClass:"row no-gutter"},[t("div",{staticClass:"col-12 m-0",class:{"p-0":!e.header}},[t("table",{staticClass:"table table-sm mb-0"},[e._l(e.steps,(function(i){return[i.show_as_header&&""!==i.name&&e.steps.length>1?t("tr",{key:i.id,staticClass:"ingredients__header-step-name"},[t("td",{attrs:{colspan:"5"}},[t("b",[e._v(e._s(i.name))])])]):e._e(),e._l(i.ingredients,(function(i){return[t("ingredient-component",{key:i.id,attrs:{ingredient:i,ingredient_factor:e.ingredient_factor,detailed:e.detailed},on:{"checked-state-changed":function(t){return e.$emit("checked-state-changed",t)}}})]}))]}))],2)])])])])])},r=[],a=i(70538),n=i(12120),o=(i(57024),i(40841)),l=i(49665);a["default"].use(n.XG7);var c={name:"IngredientCard",mixins:[l.ApiMixin],components:{IngredientComponent:o["default"]},props:{steps:{type:Array,default(){return[]}},recipe:{type:Number},ingredient_factor:{type:Number,default:1},servings:{type:Number,default:1},detailed:{type:Boolean,default:!0},header:{type:Boolean,default:!1},recipe_list:{type:Number,default:void 0}},data(){return{}},computed:{},watch:{},mounted(){},methods:{}},d=c,p=i(1001),_=(0,p.Z)(d,s,r,!1,null,null,null),u=_.exports},32825:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return e.recipe.keywords.length>0?t("div",{staticClass:"keywords"},e._l(e.recipe.keywords.slice(0,e.keyword_splice).filter((e=>e.show||void 0===e.show)),(function(i){return t("span",{key:i.id,staticClass:"keywords__item pl-1",class:e.keywordClass(i)},[e.enable_keyword_links?[t("a",{attrs:{href:`${e.resolveDjangoUrl("view_search")}?keyword=${i.id}`}},[t("b-badge",{staticClass:"font-weight-normal",attrs:{pill:"",variant:"light"}},[e._v(e._s(i.label))])],1)]:[t("b-badge",{staticClass:"font-weight-normal",attrs:{pill:"",variant:"light"}},[e._v(e._s(i.label))])]],2)})),0):e._e()},r=[],a=i(49665),n={name:"KeywordsComponent",mixins:[a.ResolveUrlMixin,a.EscapeCSSMixin],props:{recipe:Object,limit:Number,enable_keyword_links:{type:Boolean,default:!0}},computed:{keyword_splice:function(){return this.limit?this.limit:this.recipe.keywords.length}},methods:{keywordClass:function(e){return this.escapeCSS("_keywordname-"+e.label)}}},o=n,l=i(1001),c=(0,l.Z)(o,s,r,!1,null,null,null),d=c.exports},92077:function(e,t,i){i.r(t),i.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"last-cooked"},[void 0!==e.recipe.last_cooked&&null!==e.recipe.last_cooked?t("span",{staticClass:"pl-1"},[t("b-badge",{staticClass:"font-weight-normal",attrs:{pill:"",variant:"primary"}},[t("i",{staticClass:"fas fa-utensils"}),e._v(" "+e._s(e.formatDate(e.recipe.last_cooked)))])],1):e._e()])},r=[],a=i(30381),n=i.n(a),o={name:"LastCooked",props:{recipe:Object},methods:{formatDate:function(e){return n().locale(window.navigator.language),n()(e).format("L")}}},l=o,c=i(1001),d=(0,c.Z)(l,s,r,!1,null,"5a23d523",null),p=d.exports},95455:function(e,t,i){i.r(t),i.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.id_import_tandoor_modal",modifiers:{id_import_tandoor_modal:!0}}]},[e._v(e._s(e.$t("Import into Tandoor")))]),t("b-modal",{staticClass:"modal",attrs:{id:"id_import_tandoor_modal",title:e.$t("Import"),"hide-footer":""}},[t("p",[e._v("Tandoor ist eine OpenSource Rezeptverwaltungs Plattform")]),t("p",[e._v("Bitte w√§hle aus ob du deinen eigenen Tandoor Server hast oder tandoor.dev nutzt. ")]),t("div",{staticClass:"justify-content-center text-center"},[t("b-form-group",{scopedSlots:e._u([{key:"default",fn:function({ariaDescribedby:i}){return[t("b-form-radio-group",{attrs:{id:"btn-radios-1",options:e.options,"aria-describedby":i,name:"radios-btn-default",buttons:""},model:{value:e.import_mode,callback:function(t){e.import_mode=t},expression:"import_mode"}})]}}])})],1),"tandoor"===e.import_mode?t("div",[t("ol",[t("li",[t("a",{ref:"nofollow",attrs:{href:"https://app.tandoor.dev/accounts/signup/",target:"_blank"}},[e._v("Hier")]),e._v(" einen Account anlegen"),t("br")]),t("li",[t("b-button",{on:{click:function(t){return e.importTandoor()}}},[e._v("Import")])],1)])]):e._e(),"selfhosted"===e.import_mode?t("div",[e._v(" Deine Server URL (z.B. "),t("code",[e._v("https://tandoor.mydomain.com/")]),e._v(") "),t("b-input",{model:{value:e.selfhosted_url,callback:function(t){e.selfhosted_url=t},expression:"selfhosted_url"}}),t("b-button",{staticClass:"mt-2",attrs:{disabled:""===e.selfhosted_url},on:{click:function(t){return e.importSelfHosted()}}},[e._v("Import")])],1):e._e(),t("div",{staticClass:"row mt-3 text-left mb-3"},[t("p",[e._v("Alternativ kannst du den Link zum Rezept in den Importer in deiner Tandoor Instanz kopieren.")]),t("a",{attrs:{href:"https://tandoor.dev",target:"_blank",rel:"nofollow"}},[e._v("Jetzt mehr √ºber Tandoor erfahren")])])])],1)},r=[],a=i(70538),n=i(12120);i(6955);a["default"].use(n.XG7);var o={name:"ImportTandoor",components:{},props:{recipe:Object},data(){return{import_mode:"tandoor",options:[{text:"Tandoor.dev",value:"tandoor"},{text:"Self-Hosted",value:"selfhosted"}],selfhosted_url:""}},watch:{selfhosted_url:function(e){window.localStorage.setItem("MY_TANDOOR_URL",e)}},computed:{},mounted(){this.$i18n.locale=window.CUSTOM_LOCALE;let e=window.localStorage.getItem("MY_TANDOOR_URL");void 0!==e&&(this.selfhosted_url=e,this.import_mode="selfhosted")},methods:{importTandoor:function(){location.href="https://app.tandoor.dev/data/import/url?url="+location.href},importSelfHosted:function(){this.selfhosted_url=this.selfhosted_url.replace("/search/","");let e="data/import/url?url=";this.selfhosted_url.endsWith("/")||(e="/"+e),location.href=this.selfhosted_url+e+location.href}}},l=o,c=i(1001),d=(0,c.Z)(l,s,r,!1,null,null,null),p=d.exports},45491:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("iframe",{staticStyle:{border:"none"},attrs:{src:e.pdfUrl,width:"100%",height:"700px"}})])},r=[],a=i(49665),n={name:"PdfViewer",mixins:[a.ResolveUrlMixin],props:{recipe:Object},computed:{pdfUrl:function(){return(0,a.resolveDjangoStatic)("pdfjs/viewer.html?file="+(0,a.resolveDjangoUrl)("api_get_recipe_file",this.recipe.id))}}},o=n,l=i(1001),c=(0,l.Z)(o,s,r,!1,null,null,null),d=c.exports},98758:function(e,t,i){i.r(t),i.d(t,{default:function(){return _}});var s=function(){var e=this,t=e._self._c;return e.hasRecipeProperties||e.hasFoodProperties?t("div",[void 0!==e.recipe&&e.property_list.length>0?t("div",{staticClass:"card p-4 pb-2"},[t("b-row",[t("b-col",[t("h5",[t("i",{staticClass:"fas fa-database"}),e._v(" "+e._s(e.$t("Properties")))])]),t("b-col",{staticClass:"text-right"},[e.hasRecipeProperties&&e.hasFoodProperties?t("div",[e.show_recipe_properties?e._e():t("span",[e._v(e._s(e.$t("Food"))+" ")]),e.show_recipe_properties?t("span",[e._v(e._s(e.$t("Recipe"))+" ")]):e._e(),t("a",{attrs:{href:"#"},on:{click:function(t){e.show_recipe_properties=!e.show_recipe_properties}}},[e.show_recipe_properties?e._e():t("i",{staticClass:"fas fa-toggle-on"}),e.show_recipe_properties?t("i",{staticClass:"fas fa-toggle-off"}):e._e()])]):e._e()])],1),t("table",{staticClass:"table table-bordered table-sm"},[t("tr",[t("td",{staticStyle:{"border-top":"none"}}),t("td",{staticClass:"text-right",staticStyle:{"border-top":"none"}},[e._v(e._s(e.$t("per_serving")))]),t("td",{staticClass:"text-right",staticStyle:{"border-top":"none"}},[e._v(e._s(e.$t("total")))]),t("td",{staticStyle:{"border-top":"none"}})]),e._l(e.property_list,(function(i){return t("tr",{key:`id_${i.id}`},[t("td",[e._v(" "+e._s(i.name)+" ")]),t("td",{staticClass:"text-right"},[e._v(e._s(e.roundDecimals(i.property_amount_per_serving)))]),t("td",{staticClass:"text-right"},[e._v(e._s(e.roundDecimals(i.property_amount_total)))]),t("td",{},[e._v(" "+e._s(i.unit))]),e.show_recipe_properties?e._e():t("td",{staticClass:"align-middle text-center"},[t("a",{attrs:{href:"#"},on:{click:function(t){e.selected_property=i}}},[i.missing_value?t("i",{staticClass:"text-warning fas fa-exclamation-triangle"}):e._e(),i.missing_value?e._e():t("i",{staticClass:"text-muted fas fa-info-circle"})])])])}))],2),t("div",{staticClass:"text-center"},[t("b-button",{attrs:{variant:"success",href:e.resolveDjangoUrl("view_property_editor",e.recipe.id)}},[t("i",{staticClass:"fas fa-table"}),e._v(" "+e._s(e.$t("Property_Editor")))])],1)],1):e._e(),void 0!==e.selected_property?t("b-modal",{attrs:{id:"id_modal_property_overview",title:e.selected_property.name},on:{hidden:function(t){e.selected_property=void 0}},model:{value:e.show_modal,callback:function(t){e.show_modal=t},expression:"show_modal"}},[void 0!==e.selected_property?[e._v(" "+e._s(e.selected_property.description)+" "),t("table",{staticClass:"table table-bordered"},e._l(e.selected_property.food_values,(function(i){return t("tr",{key:`id_${e.selected_property.id}_food_${i.id}`},[t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return e.openFoodEditModal(i)}}},[e._v(e._s(i.food))])]),t("td",[null==i.value?[t("i",{staticClass:"text-warning fas fa-exclamation-triangle"})]:[e._v(" "+e._s(e.roundDecimals(i.value))+" "+e._s(e.selected_property.unit)+" ")]],2)])})),0)]:e._e()],2):e._e(),t("generic-modal-form",{attrs:{model:e.Models.FOOD,action:e.Actions.UPDATE,item1:e.selected_food,show:e.show_food_edit_modal},on:{hidden:e.foodEditorHidden}})],1):e._e()},r=[],a=(i(57658),i(49665)),n=i(45871),o=i(6955),l={name:"PropertyViewComponent",mixins:[a.ApiMixin],components:{GenericModalForm:n["default"]},props:{recipe:Object,servings:Number},data(){return{selected_property:void 0,selected_food:void 0,show_food_edit_modal:!1,show_recipe_properties:!1}},computed:{show_modal:function(){return void 0!==this.selected_property},hasRecipeProperties:function(){return 0!==this.recipe.properties.length},hasFoodProperties:function(){let e=!1;for(const[t,i]of Object.entries(this.recipe.food_properties))0!==i.total_value&&(e=!0);return console.log("has food propers",e),e},property_list:function(){let e=[];if(this.show_recipe_properties)this.recipe.properties.forEach((t=>{e.push({id:t.property_type.id,name:t.property_type.name,description:t.property_type.description,icon:t.property_type.icon,food_values:[],property_amount_per_serving:t.property_amount,property_amount_total:t.property_amount*this.recipe.servings*(this.servings/this.recipe.servings),missing_value:!1,unit:t.property_type.unit,type:t.property_type})}));else for(const[i,s]of Object.entries(this.recipe.food_properties))e.push({id:s.id,name:s.name,description:s.description,icon:s.icon,food_values:s.food_values,property_amount_per_serving:s.total_value/this.recipe.servings,property_amount_total:s.total_value*(this.servings/this.recipe.servings),missing_value:s.missing_value,unit:s.unit,type:s});function t(e,t){return e.type.order>t.type.order?1:e.type.order<t.type.order?-1:0}return e.sort(t)}},mounted(){this.hasRecipeProperties&&!this.hasFoodProperties&&(this.show_recipe_properties=!0)},methods:{resolveDjangoUrl:a.resolveDjangoUrl,roundDecimals:a.roundDecimals,openFoodEditModal:function(e){console.log(e);let t=(0,o.ApiApiFactory)();t.retrieveFood(e.id).then((e=>{this.selected_food=e.data,this.show_food_edit_modal=!0})).catch((e=>{a.StandardToasts.makeStandardToast(this,a.StandardToasts.FAIL_FETCH,e)}))},foodEditorHidden:function(){this.show_food_edit_modal=!1,this.$emit("foodUpdated","")}}},c=l,d=i(1001),p=(0,d.Z)(c,s,r,!1,null,"66e26d72",null),_=p.exports},11840:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"rating"},[e.recipe.rating>0?t("span",{staticClass:"d-inline"},[e.pill?t("div",[t("b-badge",{staticClass:"mt-1 font-weight-normal",attrs:{pill:"",variant:"light"}},[e._l(Math.floor(e.recipe.rating),(function(e){return t("i",{key:e,staticClass:"fas fa-star fa-xs text-dark"})})),e.recipe.rating%1>0?t("i",{staticClass:"fas fa-star-half-alt fa-xs text-dark"}):e._e(),e._l(5-Math.ceil(e.recipe.rating),(function(e){return t("i",{key:e+10,staticClass:"far fa-star fa-xs text-dark"})}))],2)],1):t("div",[e._l(Math.floor(e.recipe.rating),(function(e){return t("i",{key:e,staticClass:"fas fa-star fa-xs text-primary"})})),e.recipe.rating%1>0?t("i",{staticClass:"fas fa-star-half-alt fa-xs text-primary"}):e._e(),e._l(5-Math.ceil(e.recipe.rating),(function(e){return t("i",{key:e+10,staticClass:"far fa-star fa-xs text-secondary"})}))],2)]):e._e()])},r=[],a={name:"RecipeRating",props:{recipe:Object,pill:{required:!1,type:Boolean,default:!1}}},n=a,o=i(1001),l=(0,o.Z)(n,s,r,!1,null,"b597b90a",null),c=l.exports},1530:function(e,t,i){i.r(t),i.d(t,{default:function(){return P}});var s=function(){var e=this,t=e._self._c;return t("div",[e.loading?[t("loading-spinner")]:e._e(),e.loading?e._e():t("div",{staticStyle:{"padding-bottom":"60px"}},[e.show_recipe_switcher?t("RecipeSwitcher",{ref:"ref_recipe_switcher",on:{switch:function(t){return e.quickSwitch(t)}}}):e._e(),t("div",{staticClass:"recipe__title row"},[t("div",{staticClass:"col-12",staticStyle:{"text-align":"center"}},[t("h3",[e._v(e._s(e.recipe.name))])])]),t("div",{staticClass:"recipe__history row text-center"},[t("div",{staticClass:"col col-md-12"},[t("recipe-rating",{attrs:{recipe:e.recipe}}),t("last-cooked",{staticClass:"mt-2",attrs:{recipe:e.recipe}})],1)]),t("div",{staticClass:"recipe__description my-auto"},[t("div",{staticClass:"col-12",staticStyle:{"text-align":"center"}},[t("i",[e._v(e._s(e.recipe.description))])])]),t("div",{staticClass:"recipe__keywords",staticStyle:{"text-align":"center"}},[t("keywords-component",{attrs:{recipe:e.recipe,enable_keyword_links:e.enable_keyword_links}})],1),t("hr"),t("div",{staticClass:"recipe__prep-data row align-items-center"},[t("div",{staticClass:"recipe__prep-time col col-md-3"},[t("div",{staticClass:"d-flex"},[e._m(0),t("div",{staticClass:"my-auto mr-1"},[t("span",{staticClass:"text-primary"},[t("b",[e._v(e._s(e.$t("Preparation")))])]),t("br"),e._v(" "+e._s(e.working_time)+" ")])])]),t("div",{staticClass:"recipe__wait-time col col-md-3"},[t("div",{staticClass:"row d-flex"},[e._m(1),t("div",{staticClass:"my-auto mr-1"},[t("span",{staticClass:"text-primary"},[t("b",[e._v(e._s(e.$t("Waiting")))])]),t("br"),e._v(" "+e._s(e.waiting_time)+" ")])])]),t("div",{staticClass:"recipe__servings col col-md-4 col-10 mt-2 mt-md-0"},[t("div",{staticClass:"d-flex"},[e._m(2),t("div",{staticClass:"my-auto mr-1"},[t("CustomInputSpinButton",{model:{value:e.servings,callback:function(t){e.servings=e._n(t)},expression:"servings"}})],1),t("div",{staticClass:"my-auto mr-1"},[t("span",{staticClass:"text-primary"},[t("b",[""===e.recipe.servings_text?[e._v(e._s(e.$t("Servings")))]:[e._v(e._s(e.recipe.servings_text))]],2)])])])]),t("div",{staticClass:"recipe__context-menu col col-md-2 col-2 mt-2 mt-md-0 text-right"},[e.show_context_menu?t("recipe-context-menu",{attrs:{recipe:e.recipe,servings:e.servings,disabled_options:{print:!1}}}):e._e()],1)]),t("hr"),t("div",{staticClass:"recipe__overview row"},[e.recipe&&e.ingredient_count>0&&(e.recipe.show_ingredient_overview||e.recipe.steps.length<2)?t("div",{staticClass:"recipe__ingredients col-md-6 order-md-1 col-sm-12 order-sm-2 col-12 order-2"},[t("ingredients-card",{attrs:{recipe:e.recipe.id,steps:e.recipe.steps,ingredient_factor:e.ingredient_factor,servings:e.servings,header:!0,id:"ingredient_container"},on:{"checked-state-changed":e.updateIngredientCheckedState,"change-servings":function(t){e.servings=t}}})],1):e._e(),t("div",{staticClass:"recipe__image col-12 order-1 col-sm-12 order-sm-1 col-md-6 order-md-2"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[null!==e.recipe.image?t("img",{staticClass:"img img-fluid rounded",style:{"max-height":e.ingredient_height},attrs:{src:e.recipe.image,alt:e.$t("Recipe_Image")},on:{load:e.onImgLoad}}):e._e()])])])]),e.recipe.internal?e._e():[e.recipe.file_path.includes(".pdf")?t("div",{staticClass:"recipe__file-pdf"},[t("PdfViewer",{attrs:{recipe:e.recipe}})],1):e._e(),e.recipe.file_path.includes(".png")||e.recipe.file_path.includes(".jpg")||e.recipe.file_path.includes(".jpeg")||e.recipe.file_path.includes(".gif")?t("div",{staticClass:"recipe__file-img"},[t("ImageViewer",{attrs:{recipe:e.recipe}})],1):e._e()],e._l(e.recipe.steps,(function(i,s){return t("div",{key:i.id,staticClass:"recipe__step",staticStyle:{"margin-top":"1vh"}},[t("step-component",{attrs:{recipe:e.recipe,step:i,ingredient_factor:e.ingredient_factor,index:s,start_time:e.start_time},on:{"update-start-time":e.updateStartTime,"checked-state-changed":e.updateIngredientCheckedState}})],1)})),null!==e.recipe.source_url?t("div",{staticClass:"recipe__source"},[t("h6",{staticClass:"d-print-none"},[t("i",{staticClass:"fas fa-file-import"}),e._v(" "+e._s(e.$t("Imported_From")))]),t("span",{staticClass:"text-muted mt-1"},[t("a",{staticStyle:{"overflow-wrap":"break-word"},attrs:{href:e.recipe.source_url}},[e._v(e._s(e.recipe.source_url))])])]):e._e(),t("div",{staticClass:"recipe__properties row",staticStyle:{"margin-top":"2vh"}},[t("div",{staticClass:"col-lg-6 offset-lg-3 col-12"},[t("property-view-component",{attrs:{recipe:e.recipe,servings:e.servings},on:{foodUpdated:function(t){return e.loadRecipe(e.recipe.id)}}})],1)])],2),t("add-recipe-to-book",{attrs:{recipe:e.recipe}}),"None"===e.share_uid||e.loading?e._e():t("div",{staticClass:"row text-center d-print-none",staticStyle:{"margin-top":"3vh","margin-bottom":"3vh"}},[t("div",{staticClass:"col col-md-12"},[t("import-tandoor"),t("br"),t("a",{staticClass:"mt-3",attrs:{href:e.resolveDjangoUrl("view_report_share_abuse",e.share_uid)}},[e._v(e._s(e.$t("Report Abuse")))])],1)])],2)},r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-auto mr-1"},[t("i",{staticClass:"fas fa-fw fa-user-clock fa-2x text-primary"})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-auto mr-1"},[t("i",{staticClass:"far fa-fw fa-clock fa-2x text-primary"})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-auto mr-1"},[t("i",{staticClass:"fas fa-fw fa-pizza-slice fa-2x text-primary"})])}],a=i(70538),n=i(12120),o=(i(57024),i(36502)),l=i(21956),c=i(49665),d=i(45491),p=i(21832),_=i(30381),u=i.n(_),f=i(57609),m=i(11072),h=i(11840),v=i(92077),g=i(91515),b=i(94190),y=i(32825),C=i(98682),w=i(48561),k=(i(6955),i(95455)),x=i(98758);a["default"].prototype.moment=u(),a["default"].use(n.XG7);var S={name:"RecipeView",mixins:[c.ResolveUrlMixin,c.ToastMixin],components:{ImportTandoor:k["default"],LastCooked:v["default"],RecipeRating:h["default"],PdfViewer:d["default"],ImageViewer:p["default"],IngredientsCard:g["default"],StepComponent:b["default"],RecipeContextMenu:l["default"],KeywordsComponent:y["default"],LoadingSpinner:f["default"],AddRecipeToBook:m["default"],RecipeSwitcher:C["default"],CustomInputSpinButton:w["default"],PropertyViewComponent:x["default"]},computed:{ingredient_factor:function(){return this.servings/this.recipe.servings},ingredient_count(){return this.recipe?.steps.map((e=>e.ingredients)).flat().length},working_time:function(){return(0,c.calculateHourMinuteSplit)(this.recipe.working_time)},waiting_time:function(){return(0,c.calculateHourMinuteSplit)(this.recipe.waiting_time)}},data(){return{loading:!0,recipe:void 0,rootrecipe:void 0,servings:1,servings_cache:{},start_time:"",share_uid:window.SHARE_UID,wake_lock:null,ingredient_height:"250"}},props:{recipe_id:Number,def_servings:Number,recipe_obj:{type:Object,default:null},show_context_menu:{type:Boolean,default:!0},enable_keyword_links:{type:Boolean,default:!0},show_recipe_switcher:{type:Boolean,default:!0}},watch:{servings(e,t){this.servings_cache[this.recipe.id]=this.servings}},mounted(){null!==this.recipe_obj?(this.recipe=this.rootrecipe=this.recipe_obj,this.prepareView()):this.loadRecipe(this.recipe_id),this.$i18n.locale=window.CUSTOM_LOCALE,this.requestWakeLock(),window.addEventListener("resize",this.handleResize)},beforeUnmount(){this.destroyWakeLock()},methods:{requestWakeLock:async function(){if("wakeLock"in navigator)try{this.wake_lock=await navigator.wakeLock.request("screen"),document.addEventListener("visibilitychange",this.visibilityChange)}catch(e){console.log(e)}},handleResize:function(){null!==document.getElementById("ingredient_container")&&(this.ingredient_height=document.getElementById("ingredient_container").clientHeight)},destroyWakeLock:function(){null!=this.wake_lock&&this.wake_lock.release().then((()=>{this.wake_lock=null})),document.removeEventListener("visibilitychange",this.visibilityChange)},visibilityChange:async function(){null!=this.wake_lock&&"visible"===document.visibilityState&&await this.requestWakeLock()},loadRecipe:function(e){(0,o.vp)(e).then((e=>{this.recipe=this.rootrecipe=e,this.prepareView()}))},prepareView:function(){let e=0;for(let t of this.recipe.steps){for(let e of t.ingredients)this.$set(e,"checked",!1);t.time_offset=e,e+=t.time}e>0&&(this.start_time=u()().format("yyyy-MM-DDTHH:mm")),null===this.recipe.image&&this.printReady(),window.RECIPE_SERVINGS=Number(window.RECIPE_SERVINGS),window.RECIPE_SERVINGS&&!isNaN(window.RECIPE_SERVINGS)?this.servings=window.RECIPE_SERVINGS:this.servings=this.servings_cache[this.rootrecipe.id]=this.recipe.servings,this.loading=!1,setTimeout((()=>{this.handleResize()}),100)},updateStartTime:function(e){this.start_time=e},updateIngredientCheckedState:function(e){for(let t of this.recipe.steps)for(let i of t.ingredients)i.id===e.id&&this.$set(i,"checked",!i.checked)},quickSwitch:function(e){-1===e?(this.recipe=this.rootrecipe,this.servings=this.servings_cache[this.rootrecipe?.id??1]):(this.recipe=e,this.servings=this.servings_cache?.[e.id]??e.servings)},printReady:function(){const e=document.createElement("template");e.id="printReady",document.body.appendChild(e)},onImgLoad:function(){this.printReady()}}},R=S,$=i(1001),I=(0,$.Z)(R,s,r,!1,null,null,null),P=I.exports},96059:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("span",{staticClass:"step__scalable-num",class:[1===this.factor?"step__scalable-num_scaled_false":this.factor>1?"step__scalable-num_scaled_up":"step__scalable-num_scaled_down"],domProps:{innerHTML:e._s(e.calculateAmount(e.number))}})},r=[],a=i(49665),n={name:"ScalableNumber",props:{number:Number,factor:{type:Number,default:4}},methods:{calculateAmount:function(e){return(0,a.calculateAmount)(e,this.factor)}}},o=n,l=i(1001),c=(0,l.Z)(o,s,r,!1,null,null,null),d=c.exports},94190:function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"step",class:e.stepClassName},[t("hr"),e.recipe.steps.length>1?t("div",{staticClass:"row mb-1"},[t("div",{staticClass:"col col-md-8"},[t("h5",{staticClass:"step__name text-primary",class:e.stepClassNameType},[e._v(" "+e._s(e.step_name)+" "),0!==e.step.time?t("small",{staticClass:"step__time text-muted",staticStyle:{"margin-left":"4px"}},[t("i",{staticClass:"fas fa-user-clock"}),e._v(" "+e._s(e.step_time))]):e._e(),""!==e.start_time?t("small",{staticClass:"step__start-time d-print-none"},[t("b-link",{attrs:{id:`id_reactive_popover_${e.step.id}`,href:"#"},on:{click:e.openPopover}},[e._v(" "+e._s(e.moment(e.start_time).add(e.step.time_offset,"minutes").format("HH:mm"))+" ")])],1):e._e()])]),t("div",{staticClass:"col col-md-4 text-right"},[t("b-button",{staticClass:"shadow-none d-print-none step__button-collapse",class:{"step__button-collapse_visible text-primary":e.details_visible,"step_button-collapse_visible_false text-success":!e.details_visible},staticStyle:{border:"none",background:"none"},on:{click:function(t){e.details_visible=!e.details_visible}}},[t("i",{staticClass:"far fa-check-circle"})])],1)]):e._e(),t("b-collapse",{staticClass:"step__details",class:[e.details_visible?"step__details_visible":"step__details_visible_false"],attrs:{id:"collapse-1"},model:{value:e.details_visible,callback:function(t){e.details_visible=t},expression:"details_visible"}},[t("div",{staticClass:"row"},[e.step.show_ingredients_table&&e.step.ingredients.length>0&&(e.recipe.steps.length>1||e.force_ingredients)?t("div",{staticClass:"step__ingredients col col-md-4"},[t("table",{staticClass:"table table-sm"},[t("ingredients-card",{attrs:{steps:[e.step],ingredient_factor:e.ingredient_factor},on:{"checked-state-changed":function(t){return e.$emit("checked-state-changed",t)}}})],1)]):e._e(),t("div",{staticClass:"step__instructions col",class:{"col-md-8 col-12":e.recipe.steps.length>1,"col-md-12 col-12":e.recipe.steps.length<=1}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col col-md-12"},[t("compile-component",{attrs:{code:e.step.instructions_markdown,ingredient_factor:e.ingredient_factor}})],1)]),null!==e.step.file?t("div",{staticClass:"step__file row"},[t("div",{staticClass:"col col-md-12"},[[""!==e.step.file.preview?t("div",[t("b-img",{attrs:{src:e.step.file.preview,"fluid-grow":""}})],1):t("div",[t("a",{attrs:{href:e.step.file.file_download,target:"_blank",rel:"noreferrer nofollow"}},[e._v(e._s(e.$t("Download"))+" "+e._s(e.$t("File")))])])]],2)]):e._e()])]),t("div",{staticClass:"step__subrecipe row"},[t("div",{staticClass:"col col-md-12"},[null!==e.step.step_recipe_data?t("div",{staticClass:"card"},[t("b-collapse",{class:[e.details_visible?"step__details_visible":"step__details_visible_false"],attrs:{id:"collapse-1"},model:{value:e.details_visible,callback:function(t){e.details_visible=t},expression:"details_visible"}},[t("div",{staticClass:"card-body"},[t("h2",{staticClass:"card-title"},[t("a",{attrs:{href:e.resolveDjangoUrl("view_recipe",e.step.step_recipe_data.id)}},[e._v(e._s(e.step.step_recipe_data.name))])]),e._l(e.step.step_recipe_data.steps,(function(i,s){return t("div",{key:`substep_${i.id}`},[t("step-component",{attrs:{recipe:e.step.step_recipe_data,step:i,ingredient_factor:e.ingredient_factor,index:s,start_time:e.start_time,force_ingredients:!0}})],1)}))],2)])],1):e._e()])])]),""!==e.start_time?t("div",[t("b-popover",{ref:`id_reactive_popover_${e.step.id}`,attrs:{target:`id_reactive_popover_${e.step.id}`,triggers:"click",placement:"bottom",title:e.$t("Step start time")}},[t("div",[t("b-form-group",{staticClass:"mb-1",attrs:{label:"Time","label-for":"popover-input-1","label-cols":"3"}},[t("b-form-input",{attrs:{type:"datetime-local",id:"popover-input-1",size:"sm"},model:{value:e.set_time_input,callback:function(t){e.set_time_input=t},expression:"set_time_input"}})],1)],1),t("div",{staticClass:"row",staticStyle:{"margin-top":"1vh"}},[t("div",{staticClass:"col-12",staticStyle:{"text-align":"right"}},[t("b-button",{staticStyle:{"margin-right":"8px"},attrs:{size:"sm",variant:"secondary"},on:{click:e.closePopover}},[e._v(" "+e._s(e.$t("Cancel"))+" ")]),t("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:e.updateTime}},[e._v(e._s(e.$t("Ok")))])],1)])])],1):e._e()],1)},r=[],a=i(49665),n=i(68697),o=i(91515),l=i(70538),c=i(30381),d=i.n(c);l["default"].prototype.moment=d();var p={name:"StepComponent",mixins:[a.GettextMixin,a.ResolveUrlMixin,a.EscapeCSSMixin],components:{CompileComponent:n["default"],IngredientsCard:o["default"]},props:{step:Object,ingredient_factor:Number,index:Number,recipe:Object,start_time:String,force_ingredients:{type:Boolean,default:!1}},computed:{step_time:function(){return(0,a.calculateHourMinuteSplit)(this.step.time)},step_name:function(){return this.step.name?this.step.name:this.$t("Step")+" "+String(this.index+1)},stepClassName:function(){let e={};const t=this.escapeCSS("_stepname-"+this.step_name);return e[t]=!!this.step.name,e["_stepname-"+String(this.index+1)]=!this.step.name,e},stepClassNameType:function(){let e={};return e["step__name_custom"]=!!this.step.name,e["step__name_custom_false"]=!this.step.name,e}},data(){return{details_visible:!0,set_time_input:""}},mounted(){this.set_time_input=d()(this.start_time).add(this.step.time_offset,"minutes").format("yyyy-MM-DDTHH:mm")},methods:{calculateAmount:function(e){return(0,a.calculateAmount)(e,this.ingredient_factor)},updateTime:function(){let e=d()(this.set_time_input).add(-1*this.step.time_offset,"minutes").format("yyyy-MM-DDTHH:mm");this.$emit("update-start-time",e),this.closePopover()},closePopover:function(){this.$refs[`id_reactive_popover_${this.step.id}`].$emit("close")},openPopover:function(){this.$refs[`id_reactive_popover_${this.step.id}`].$emit("open")}}},_=p,u=i(1001),f=(0,u.Z)(_,s,r,!1,null,null,null),m=f.exports},58536:function(e,t,i){i(68185)},70179:function(e,t,i){var s=i(6361);t.Z=s.Z},68185:function(){},6361:function(e,t,i){i(57658);var s=i(49665);const{ApiApiFactory:r}=i(6955);t.Z={name:"RecipeSwitcher",mixins:[s.ResolveUrlMixin],props:{recipe:{type:Number,default:void 0}},data(){return{related_recipes:[],planned_recipes:[],pinned_recipes:[],recipes:{}}},computed:{is_recipe_view:function(){return this.$root._vnode.tag.includes("RecipeView")}},mounted(){let e=[];e.push(this.loadRelatedRecipes()),this.loadPinnedRecipes(),e.push(this.loadMealPlans()),Promise.all(e).then((()=>{this.loadRecipeData()}))},methods:{navRecipe:function(e){this.is_recipe_view?this.$emit("switch",this.recipes[e.id]):window.location.href=this.resolveDjangoUrl("view_recipe",e.id)},updatePinnedRecipes:function(){this.loadPinnedRecipes(),this.loadRecipeData()},loadRecipeData:function(){let e=new r,t=[...this.related_recipes,...this.planned_recipes,...this.pinned_recipes],i=[];t.forEach((e=>{let t=e.id;i.includes(t)||i.push(t)})),i.forEach((t=>{e.retrieveRecipe(t).then((e=>{this.recipes[t]=e.data}))}))},loadRelatedRecipes:function(){let e=new r;if(this.$parent.recipe)return this.related_recipes=[this.$parent.recipe],e.relatedRecipe(this.$parent.recipe.id,{query:{levels:2,format:"json"}}).then((e=>{this.related_recipes=this.related_recipes.concat(e.data)}))},loadPinnedRecipes:function(){let e=JSON.parse(localStorage.getItem("pinned_recipes"))||[];this.pinned_recipes=e},loadMealPlans:function(){let e=new r;var t=6e4*(new Date).getTimezoneOffset();let i=new Date(Date.now()-t).toISOString().split("T")[0];return e.listMealPlans(i,i).then((t=>{let i=[];return t.data.forEach((t=>{this.planned_recipes.push({...t?.recipe,servings:t?.servings});const s=(t?.servings??t?.recipe?.servings??1)/(t?.recipe?.servings??1);i.push(e.relatedRecipe(t?.recipe?.id,{query:{levels:2}}).then((e=>{e.data=e.data.map((e=>({...e,factor:s}))),this.planned_recipes=[...this.planned_recipes,...e.data]})))})),Promise.all(i)}))},unPinRecipe:function(e){let t=JSON.parse(localStorage.getItem("pinned_recipes"))||[];t=t.filter((t=>t.id!==e.id)),console.log("pinned left",t),this.pinned_recipes=t,localStorage.setItem("pinned_recipes",JSON.stringify(t))}}}}}]);