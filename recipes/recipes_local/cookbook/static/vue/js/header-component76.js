"use strict";(self["webpackChunktandoor"]=self["webpackChunktandoor"]||[]).push([[366],{69663:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var o=function(){var e=this,t=e._self._c;return t("div",[t("h1",[e._v("EDITOR")]),t("b-button",{on:{click:function(t){return e.toolbarTest()}}},[e._v("Heading")]),t("b-button",{on:{click:function(t){return e.bold()}}},[e._v("B")]),t("div",{staticStyle:{"background-color":"#fff",border:"solid 1px"},attrs:{id:"editor"}})],1)},i=[],s=n(61369),r=(n(57658),n(78120)),a=n(75533),d=n(45383),c=n(13213),l=n(34790),u=n(59119);class h extends a.l9{constructor(e,t){super(),(0,s.Z)(this,"name",void 0),(0,s.Z)(this,"ingredients",[]),this.name=e,this.ingredients=t}getIngredientLabel(e){return`${e.amount} ${e.unit.name} ${e.food.name}`}toDOM(){let e=document.createElement("span"),t="ERROR";if(this.name.includes("ingredients")){let e=this.name.replace("{{ ingredients[","").replace("] }}","");t=this.getIngredientLabel(this.ingredients[e])}return this.name.includes("scale(")&&(t=this.name.replace("{{ scale(","").replace(") }}","")),e.innerHTML=t,e.style.cssText=" border: 1px solid blue; border-radius: 4px; padding: 0 3px; background: lightblue;",e}ignoreEvent(){return!1}}var m={name:"MarkdownEditorComponent",props:{},computed:{autocomplete_options(){let e=[],t=0;for(let n of this.ingredients)e.push({label:n.food.name,type:"text",apply:`{{ ingredients[${t}] }}`,detail:`${n.amount} ${n.unit.name} ${n.food.name}`}),t++;return e.push({label:"Scale",type:"text",apply:"{{ scale(100) }}",detail:"simple scalable number"}),e}},data(){return{editor_view:null,ingredients:[{amount:20,food:{name:"raspberry"},unit:{name:"pcs"}},{amount:100,food:{name:"sugar"},unit:{name:"g"}},{amount:250,food:{name:"water"},unit:{name:"ml"}},{amount:1,food:{name:"salt"},unit:{name:"pinch"}}]}},mounted(){const e=new a.Y1({regexp:/\{\{ (?:scale\(\d+\)|ingredients\[\d+\]) \}\}/g,decorate:(e,t,n,o,i)=>{const s=new h(o[0],this.ingredients);e(n,n,a.p.widget({widget:s,side:1}))}}),t=a.lg.fromClass(class{constructor(t){(0,s.Z)(this,"decorations",void 0),this.decorations=e.createDeco(t)}update(t){this.decorations=e.updateDeco(t,this.decorations)}},{decorations:e=>e.decorations});let n=r.yy.create({doc:"## Header\n\nDas ist eine Beschreibung [test](https://google.com) \nPacke {{ ingredients[1] }} in das Fass mit {{ ingredients[3] }}\nTest Bla Bla {{ scale(100) }} \n\n- test\n- test 2\n- test3",extensions:[(0,d.m8)(),(0,u.nF)(u.R_),a.$f.of(d.wQ),t,(0,c.JH)({base:c.eg,highlightFormatting:!0}),(0,l.ys)({override:[this.foodTemplateAutoComplete]})]});this.editor_view=new a.tk({state:n,extensions:[],parent:document.getElementById("editor")})},methods:{foodTemplateAutoComplete:function(e){let t=e.matchBefore(/\w*/);return t.from!==t.to||e.explicit?{from:t.from,options:this.autocomplete_options}:null},toolbarTest(){const e=this.editor_view.state.changeByRange((e=>{const t="###",n=this.editor_view.state.doc.toString();let o=this.editor_view.state.sliceDoc(e.from,e.to),i=e.from;while(i>0){if("\n"===n[i-1])break;i-=1}o=this.editor_view.state.sliceDoc(i,e.to);const s=`\n${o}`,a=s.replace(/\n/g,`\n${t}`),d={from:i,to:e.to,insert:a,anchor:i+t.length+1,textBefore:s};return{changes:d,range:r.jT.range(d.anchor,d.anchor)}}));this.editor_view.dispatch(e)},bold(){const e=this.editor_view.state.changeByRange((e=>{if(e.anchor!==e.head){let t=this.editor_view.state.sliceDoc(e.from,e.to),n=`**${t}**`;const o={from:e.from,to:e.to,insert:n};return{changes:o,range:r.jT.range(e.anchor+2,e.head+2)}}console.log("nothing selected --\x3e nothing bold")}));this.editor_view.dispatch(e)},heading(e,t){}}},g=m,p=n(1001),f=(0,p.Z)(g,o,i,!1,null,null,null),b=f.exports}}]);