"use strict";(self["webpackChunktandoor"]=self["webpackChunktandoor"]||[]).push([[3295,6018],{43657:function(t,e,a){a.r(e),a.d(e,{default:function(){return _}});var s=function(){var t=this,e=t._self._c;return e("b-alert",{attrs:{show:"",variant:"warning"}},[e("b-badge",[t._v("BETA")]),t._v(" "+t._s(t.$t("warning_feature_beta"))+" ")],1)},n=[],o={name:"BetaWarning"},r=o,i=a(1001),d=(0,i.Z)(r,s,n,!1,null,"05d0dded",null),_=d.exports},66379:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var s=function(){var t=this,e=t._self._c;return e("div",[e("beta-warning"),void 0!==t.metadata?e("div",[t._v(" "+t._s(t.$t("Data_Import_Info"))+" "),e("a",{attrs:{href:"https://github.com/TandoorRecipes/open-tandoor-data",target:"_blank",rel:"noreferrer nofollow"}},[t._v(t._s(t.$t("Learn_More")))]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selected_version,expression:"selected_version"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected_version=e.target.multiple?a:a[0]}}},t._l(t.metadata.versions,(function(a){return e("option",{key:a},[t._v(t._s(a))])})),0),e("b-checkbox",{staticClass:"mt-1",model:{value:t.update_existing,callback:function(e){t.update_existing=e},expression:"update_existing"}},[t._v(t._s(t.$t("Update_Existing_Data")))]),e("b-checkbox",{staticClass:"mt-1",model:{value:t.use_metric,callback:function(e){t.use_metric=e},expression:"use_metric"}},[t._v(t._s(t.$t("Use_Metric")))]),void 0!==t.selected_version?e("div",{staticClass:"mt-3"},[e("table",{staticClass:"table"},[e("tr",[e("th",[t._v(t._s(t.$t("Import")))]),e("th",[t._v(t._s(t.$t("Datatype")))]),e("th",[t._v(t._s(t.$t("Number of Objects")))]),e("th",[t._v(t._s(t.$t("Imported")))])]),t._l(t.datatypes,(function(a){return e("tr",{key:a.name},[e("td",[e("b-checkbox",{model:{value:a.selected,callback:function(e){t.$set(a,"selected",e)},expression:"d.selected"}})],1),e("td",[t._v(t._s(t.$t(a.name.charAt(0).toUpperCase()+a.name.slice(1))))]),e("td",[t._v(t._s(t.metadata[t.selected_version][a.name]))]),e("td",[a.name in t.import_count?[e("i",{staticClass:"fas fa-plus-circle"}),t._v(" "+t._s(t.import_count[a.name]["total_created"])+" "+t._s(t.$t("Created"))+" "),e("br"),e("i",{staticClass:"fas fa-pencil-alt"}),t._v(" "+t._s(t.import_count[a.name]["total_updated"])+" "+t._s(t.$t("Updated"))+" "),e("br"),e("i",{staticClass:"fas fa-forward"}),t._v(" "+t._s(t.import_count[a.name]["total_untouched"])+" "+t._s(t.$t("Unchanged"))+" "),e("br"),e("i",{staticClass:"fas fa-exclamation-circle"}),t._v(" "+t._s(t.import_count[a.name]["total_errored"])+" "+t._s(t.$t("Error"))+" ")]:t._e()],2)])}))],2),e("button",{staticClass:"btn btn-success",on:{click:t.doImport}},[t._v(t._s(t.$t("Import")))])]):t._e()],1):t._e()],1)},n=[],o=a(70538),r=a(12120),i=(a(57024),a(49665)),d=a(5121),_=a(43657);o["default"].use(r.XG7);var c={name:"OpenDataImportComponent",mixins:[i.ApiMixin],components:{BetaWarning:_["default"]},data(){return{metadata:void 0,datatypes:{},selected_version:void 0,update_existing:!0,use_metric:!0,import_count:{}}},mounted(){this.$i18n.locale=window.CUSTOM_LOCALE,d.Z.get((0,i.resolveDjangoUrl)("api_import_open_data")).then((t=>{this.metadata=t.data;for(let e in this.metadata.datatypes)this.datatypes[this.metadata.datatypes[e]]={name:this.metadata.datatypes[e],selected:!1}})).catch((t=>{i.StandardToasts.makeStandardToast(this,i.StandardToasts.FAIL_FETCH,t)}))},methods:{doImport:function(){d.Z.post((0,i.resolveDjangoUrl)("api_import_open_data"),{selected_version:this.selected_version,selected_datatypes:this.datatypes,update_existing:this.update_existing,use_metric:this.use_metric}).then((t=>{i.StandardToasts.makeStandardToast(this,i.StandardToasts.SUCCESS_CREATE),this.import_count=Object.assign({},this.import_count,t.data)})).catch((t=>{i.StandardToasts.makeStandardToast(this,i.StandardToasts.FAIL_CREATE,t)}))}}},l=c,u=a(1001),m=(0,u.Z)(l,s,n,!1,null,null,null),p=m.exports}}]);