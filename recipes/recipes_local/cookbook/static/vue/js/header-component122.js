"use strict";(self["webpackChunktandoor"]=self["webpackChunktandoor"]||[]).push([[5208],{98758:function(e,t,o){o.r(t),o.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return e.hasRecipeProperties||e.hasFoodProperties?t("div",[void 0!==e.recipe&&e.property_list.length>0?t("div",{staticClass:"card p-4 pb-2"},[t("b-row",[t("b-col",[t("h5",[t("i",{staticClass:"fas fa-database"}),e._v(" "+e._s(e.$t("Properties")))])]),t("b-col",{staticClass:"text-right"},[e.hasRecipeProperties&&e.hasFoodProperties?t("div",[e.show_recipe_properties?e._e():t("span",[e._v(e._s(e.$t("Food"))+" ")]),e.show_recipe_properties?t("span",[e._v(e._s(e.$t("Recipe"))+" ")]):e._e(),t("a",{attrs:{href:"#"},on:{click:function(t){e.show_recipe_properties=!e.show_recipe_properties}}},[e.show_recipe_properties?e._e():t("i",{staticClass:"fas fa-toggle-on"}),e.show_recipe_properties?t("i",{staticClass:"fas fa-toggle-off"}):e._e()])]):e._e()])],1),t("table",{staticClass:"table table-bordered table-sm"},[t("tr",[t("td",{staticStyle:{"border-top":"none"}}),t("td",{staticClass:"text-right",staticStyle:{"border-top":"none"}},[e._v(e._s(e.$t("per_serving")))]),t("td",{staticClass:"text-right",staticStyle:{"border-top":"none"}},[e._v(e._s(e.$t("total")))]),t("td",{staticStyle:{"border-top":"none"}})]),e._l(e.property_list,(function(o){return t("tr",{key:`id_${o.id}`},[t("td",[e._v(" "+e._s(o.name)+" ")]),t("td",{staticClass:"text-right"},[e._v(e._s(e.roundDecimals(o.property_amount_per_serving)))]),t("td",{staticClass:"text-right"},[e._v(e._s(e.roundDecimals(o.property_amount_total)))]),t("td",{},[e._v(" "+e._s(o.unit))]),e.show_recipe_properties?e._e():t("td",{staticClass:"align-middle text-center"},[t("a",{attrs:{href:"#"},on:{click:function(t){e.selected_property=o}}},[o.missing_value?t("i",{staticClass:"text-warning fas fa-exclamation-triangle"}):e._e(),o.missing_value?e._e():t("i",{staticClass:"text-muted fas fa-info-circle"})])])])}))],2),t("div",{staticClass:"text-center"},[t("b-button",{attrs:{variant:"success",href:e.resolveDjangoUrl("view_property_editor",e.recipe.id)}},[t("i",{staticClass:"fas fa-table"}),e._v(" "+e._s(e.$t("Property_Editor")))])],1)],1):e._e(),void 0!==e.selected_property?t("b-modal",{attrs:{id:"id_modal_property_overview",title:e.selected_property.name},on:{hidden:function(t){e.selected_property=void 0}},model:{value:e.show_modal,callback:function(t){e.show_modal=t},expression:"show_modal"}},[void 0!==e.selected_property?[e._v(" "+e._s(e.selected_property.description)+" "),t("table",{staticClass:"table table-bordered"},e._l(e.selected_property.food_values,(function(o){return t("tr",{key:`id_${e.selected_property.id}_food_${o.id}`},[t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return e.openFoodEditModal(o)}}},[e._v(e._s(o.food))])]),t("td",[null==o.value?[t("i",{staticClass:"text-warning fas fa-exclamation-triangle"})]:[e._v(" "+e._s(e.roundDecimals(o.value))+" "+e._s(e.selected_property.unit)+" ")]],2)])})),0)]:e._e()],2):e._e(),t("generic-modal-form",{attrs:{model:e.Models.FOOD,action:e.Actions.UPDATE,item1:e.selected_food,show:e.show_food_edit_modal},on:{hidden:e.foodEditorHidden}})],1):e._e()},s=[],i=(o(57658),o(49665)),a=o(45871),p=o(6955),n={name:"PropertyViewComponent",mixins:[i.ApiMixin],components:{GenericModalForm:a["default"]},props:{recipe:Object,servings:Number},data(){return{selected_property:void 0,selected_food:void 0,show_food_edit_modal:!1,show_recipe_properties:!1}},computed:{show_modal:function(){return void 0!==this.selected_property},hasRecipeProperties:function(){return 0!==this.recipe.properties.length},hasFoodProperties:function(){let e=!1;for(const[t,o]of Object.entries(this.recipe.food_properties))0!==o.total_value&&(e=!0);return console.log("has food propers",e),e},property_list:function(){let e=[];if(this.show_recipe_properties)this.recipe.properties.forEach((t=>{e.push({id:t.property_type.id,name:t.property_type.name,description:t.property_type.description,icon:t.property_type.icon,food_values:[],property_amount_per_serving:t.property_amount,property_amount_total:t.property_amount*this.recipe.servings*(this.servings/this.recipe.servings),missing_value:!1,unit:t.property_type.unit,type:t.property_type})}));else for(const[o,r]of Object.entries(this.recipe.food_properties))e.push({id:r.id,name:r.name,description:r.description,icon:r.icon,food_values:r.food_values,property_amount_per_serving:r.total_value/this.recipe.servings,property_amount_total:r.total_value*(this.servings/this.recipe.servings),missing_value:r.missing_value,unit:r.unit,type:r});function t(e,t){return e.type.order>t.type.order?1:e.type.order<t.type.order?-1:0}return e.sort(t)}},mounted(){this.hasRecipeProperties&&!this.hasFoodProperties&&(this.show_recipe_properties=!0)},methods:{resolveDjangoUrl:i.resolveDjangoUrl,roundDecimals:i.roundDecimals,openFoodEditModal:function(e){console.log(e);let t=(0,p.ApiApiFactory)();t.retrieveFood(e.id).then((e=>{this.selected_food=e.data,this.show_food_edit_modal=!0})).catch((e=>{i.StandardToasts.makeStandardToast(this,i.StandardToasts.FAIL_FETCH,e)}))},foodEditorHidden:function(){this.show_food_edit_modal=!1,this.$emit("foodUpdated","")}}},d=n,_=o(1001),l=(0,_.Z)(d,r,s,!1,null,"66e26d72",null),c=l.exports}}]);